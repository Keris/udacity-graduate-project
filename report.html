<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.8">
<meta name="author" content="杜 利强">
<title>机器学习工程师纳米学位</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Uncomment @import statement below to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock pre.nowrap,.literalblock pre.nowrap pre,.listingblock pre.nowrap,.listingblock pre.nowrap pre{white-space:pre;word-wrap:normal}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #dddddf}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt,.quoteblock .quoteblock{margin:0 0 1.25em;padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
.listingblock .pygments .hll { background-color: #ffffcc }
.listingblock .pygments, .listingblock .pygments code { background: #ffffff; }
.listingblock .pygments .tok-c { color: #177500 } /* Comment */
.listingblock .pygments .tok-err { color: #000000 } /* Error */
.listingblock .pygments .tok-k { color: #A90D91 } /* Keyword */
.listingblock .pygments .tok-l { color: #1C01CE } /* Literal */
.listingblock .pygments .tok-n { color: #000000 } /* Name */
.listingblock .pygments .tok-o { color: #000000 } /* Operator */
.listingblock .pygments .tok-ch { color: #177500 } /* Comment.Hashbang */
.listingblock .pygments .tok-cm { color: #177500 } /* Comment.Multiline */
.listingblock .pygments .tok-cp { color: #633820 } /* Comment.Preproc */
.listingblock .pygments .tok-cpf { color: #177500 } /* Comment.PreprocFile */
.listingblock .pygments .tok-c1 { color: #177500 } /* Comment.Single */
.listingblock .pygments .tok-cs { color: #177500 } /* Comment.Special */
.listingblock .pygments .tok-kc { color: #A90D91 } /* Keyword.Constant */
.listingblock .pygments .tok-kd { color: #A90D91 } /* Keyword.Declaration */
.listingblock .pygments .tok-kn { color: #A90D91 } /* Keyword.Namespace */
.listingblock .pygments .tok-kp { color: #A90D91 } /* Keyword.Pseudo */
.listingblock .pygments .tok-kr { color: #A90D91 } /* Keyword.Reserved */
.listingblock .pygments .tok-kt { color: #A90D91 } /* Keyword.Type */
.listingblock .pygments .tok-ld { color: #1C01CE } /* Literal.Date */
.listingblock .pygments .tok-m { color: #1C01CE } /* Literal.Number */
.listingblock .pygments .tok-s { color: #C41A16 } /* Literal.String */
.listingblock .pygments .tok-na { color: #836C28 } /* Name.Attribute */
.listingblock .pygments .tok-nb { color: #A90D91 } /* Name.Builtin */
.listingblock .pygments .tok-nc { color: #3F6E75 } /* Name.Class */
.listingblock .pygments .tok-no { color: #000000 } /* Name.Constant */
.listingblock .pygments .tok-nd { color: #000000 } /* Name.Decorator */
.listingblock .pygments .tok-ni { color: #000000 } /* Name.Entity */
.listingblock .pygments .tok-ne { color: #000000 } /* Name.Exception */
.listingblock .pygments .tok-nf { color: #000000 } /* Name.Function */
.listingblock .pygments .tok-nl { color: #000000 } /* Name.Label */
.listingblock .pygments .tok-nn { color: #000000 } /* Name.Namespace */
.listingblock .pygments .tok-nx { color: #000000 } /* Name.Other */
.listingblock .pygments .tok-py { color: #000000 } /* Name.Property */
.listingblock .pygments .tok-nt { color: #000000 } /* Name.Tag */
.listingblock .pygments .tok-nv { color: #000000 } /* Name.Variable */
.listingblock .pygments .tok-ow { color: #000000 } /* Operator.Word */
.listingblock .pygments .tok-mb { color: #1C01CE } /* Literal.Number.Bin */
.listingblock .pygments .tok-mf { color: #1C01CE } /* Literal.Number.Float */
.listingblock .pygments .tok-mh { color: #1C01CE } /* Literal.Number.Hex */
.listingblock .pygments .tok-mi { color: #1C01CE } /* Literal.Number.Integer */
.listingblock .pygments .tok-mo { color: #1C01CE } /* Literal.Number.Oct */
.listingblock .pygments .tok-sa { color: #C41A16 } /* Literal.String.Affix */
.listingblock .pygments .tok-sb { color: #C41A16 } /* Literal.String.Backtick */
.listingblock .pygments .tok-sc { color: #2300CE } /* Literal.String.Char */
.listingblock .pygments .tok-dl { color: #C41A16 } /* Literal.String.Delimiter */
.listingblock .pygments .tok-sd { color: #C41A16 } /* Literal.String.Doc */
.listingblock .pygments .tok-s2 { color: #C41A16 } /* Literal.String.Double */
.listingblock .pygments .tok-se { color: #C41A16 } /* Literal.String.Escape */
.listingblock .pygments .tok-sh { color: #C41A16 } /* Literal.String.Heredoc */
.listingblock .pygments .tok-si { color: #C41A16 } /* Literal.String.Interpol */
.listingblock .pygments .tok-sx { color: #C41A16 } /* Literal.String.Other */
.listingblock .pygments .tok-sr { color: #C41A16 } /* Literal.String.Regex */
.listingblock .pygments .tok-s1 { color: #C41A16 } /* Literal.String.Single */
.listingblock .pygments .tok-ss { color: #C41A16 } /* Literal.String.Symbol */
.listingblock .pygments .tok-bp { color: #5B269A } /* Name.Builtin.Pseudo */
.listingblock .pygments .tok-fm { color: #000000 } /* Name.Function.Magic */
.listingblock .pygments .tok-vc { color: #000000 } /* Name.Variable.Class */
.listingblock .pygments .tok-vg { color: #000000 } /* Name.Variable.Global */
.listingblock .pygments .tok-vi { color: #000000 } /* Name.Variable.Instance */
.listingblock .pygments .tok-vm { color: #000000 } /* Name.Variable.Magic */
.listingblock .pygments .tok-il { color: #1C01CE } /* Literal.Number.Integer.Long */
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>机器学习工程师纳米学位</h1>
<div class="details">
<span id="author" class="author">杜 利强</span><br>
<span id="email" class="email"><a href="mailto:dlq137@gmail.com">dlq137@gmail.com</a></span><br>
<span id="revnumber">version v0.1,</span>
<span id="revdate">01.04.2019</span>
<br><span id="revremark">First Draft</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_项目背景">1. 项目背景</a></li>
<li><a href="#_问题描述">2. 问题描述</a></li>
<li><a href="#_数据集和输入">3. 数据集和输入</a></li>
<li><a href="#Solution-Description">4. 解决方案描述</a></li>
<li><a href="#_基准模型">5. 基准模型</a></li>
<li><a href="#Metrics">6. 评估指标</a></li>
<li><a href="#_项目设计">7. 项目设计</a>
<ul class="sectlevel2">
<li><a href="#_takeoff_任务">7.1. Takeoff 任务</a></li>
<li><a href="#_hover_任务">7.2. Hover 任务</a></li>
<li><a href="#_landing_任务">7.3. Landing 任务</a></li>
<li><a href="#_reflections">7.4. Reflections</a></li>
</ul>
</li>
<li><a href="#_参考">8. 参考</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_项目背景"><a class="link" href="#_项目背景">1. 项目背景</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>近年来，<strong>深度学习（Deep Leaning，DL）</strong> 得到了快速的发展。在2015年底，微软亚洲研究院的研究员提出了一个新的基于CNN的深度模型，称之为残差网络，该残差网络深度高达152层，取得了当时图像识别比赛上面最好的成绩。
在2016年初，DeeopMind基于深度强化学习技术开发的AlphaGo打败了围棋世界冠军李世石。深度学习的成功主要归功于三大因素：<strong>大数据、大模型和大计算</strong>。
 现阶段可以利用的数据特别是标注数据非常多，使得我们能够从数据中学到以前没法学习的东西。另外，技术上的发展使得训练大模型成为可能，如上千层的深度神经网络。最后，可获取的计算资源越来越丰富，从CPU到GPU到FPGA，这属于大计算。</p>
</div>
<div class="paragraph">
<p>以上提及的三大要素成就了深度学习，但同时也为深度学习的进一步发展和普带来了一些制约因素。
首先，标注数据代价昂贵，从无标注的数据里学习成为深度学习的一个前沿，已经有这方面的研究工作，包括生成式对抗网络和对偶学习。
二是如何得到一些比较小的模型使得深度学习技术能够在移动设备和各种场所里面得到更广法的应用。
三是如何设计更快更高效的深度学习算法。四是如何把数据和知识结合起来。五是如何把深度学习的成功从一些静态的任务扩展到复杂的动态决策任务上去。</p>
</div>
<div class="paragraph">
<p>前述提到的第五点，深度强化学习（Deep Reinforcement Learning, DRL）就是针对其做的一个很好的尝试。
2015年，DeepMind的Volodymyr Mnih等研究员在《自然》杂志上发表论文 <em>Human-level control through deep reinforcement learning</em>，
该论文提出了一个结合深度学习（DL）技术和强化学习（RL）思想的模型Deep Q-Network(DQN)，在Atari游戏平台上展示出超越人类水平的表现。
自此以后，结合DL与RL的深度强化学习（Deep Reinforcement Learning, DRL）迅速成为人工智能界的焦点。</p>
</div>
<div class="paragraph">
<p>强化学习（Reinforcement Learning， RL）是与决策执行（decision making）和电机控制（motor control）有关的机器学习的子领域。它研究agent如何在复杂、不确定的环境中学习如何实现目标。</p>
</div>
<div class="paragraph">
<p>强化学习能做什么以及表现：</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>RL非常通用，涵盖了涉及做出一系列决策的所有问题。</strong> 例如，控制机器人的电机，使其能够跑和跳，做出商业决策，如定价和库存管理，或玩视频游戏和棋牌游戏。RL甚至可以应用于具有顺序或结构化输出的监督学习问题。</p>
</li>
<li>
<p><strong>RL算法已经开始在许多困难环境中取得良好效果。</strong>  正如前面提到的，深度学习和强化学习的结合使DRL成为了人工智能的焦点，有很多亮眼表现：在视频游戏（Dota）、棋类游戏（围棋）上打败人类顶尖高手；控制复杂的机械进行操作；调配网络资源；为数据中心大幅节能；甚至对机器学习算法自动调参。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>然而，RL的研究也存在制约因素：</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>需要建立更好的基准。</strong> 在监督学习中，ImageNet这样的大型标记数据集驱动了其发展。在RL中，最接近的等价物是大量且多样化的环境集合。 但是，RL环境的现有开源集合没有足够的多样性，并且它们通常难以设置和使用。在这方面，OpenAI做出了突出的贡献。</p>
</li>
<li>
<p><strong>使用的环境缺乏标准化。</strong> 问题定义中的细微差别，例如奖励函数或动作集，可以极大地改变任务的难度。这个问题导致DRL的可复现性危机。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>调查发现，RL已经在各个领域被广泛使用：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>控制领域。是RL思想的发源地之一，也是RL技术应用最成熟的领域。</p>
</li>
<li>
<p>自动驾驶领域。从80年代的ALVINN、TORCS到如今的CARLA。</p>
</li>
<li>
<p>NLP领域。对话系统、机器写作等。</p>
</li>
<li>
<p>推荐系统与检索系统领域。</p>
</li>
<li>
<p>金融领域。</p>
</li>
<li>
<p>进行数据选择。</p>
</li>
<li>
<p>通讯、生产调度、规划和资源访问控制等运筹领域。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>四轴飞行器</strong>在个人和专业应用领域都变得越来越热门。它易于操控，并广泛应用于各个领域，从最后一公里投递到电影摄影，从杂技表演到搜救，无所不包。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/parrot-ar.png" alt="无人机">
</div>
</div>
<div class="paragraph">
<p>四轴飞行器控制是强化学习在控制领域的一个典型应用，在该项目中需要设计一个深度强化学习智能体，来控制几个四轴飞行器的飞行任务，包括起飞、悬停和着陆。相比而言，DL中学习器（learner）都是学会怎么做，而在RL中，智能体需要在与环境不断互动和探索的过程中根据奖励或惩罚选择动作不断学习，这十分有趣，并且具有挑战性。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_问题描述"><a class="link" href="#_问题描述">2. 问题描述</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>项目的目的为训练一个四轴飞行器学会如何飞行。具体为设计一个深度强化学习智能体，来控制几个四轴飞行器的飞行任务，包括起飞、悬停和着陆。在正式开始之前，需要安装ROS以及下载对应的模拟器，然后运行ROS和模拟器并确保两者能够正常连接，详细的步骤参见 <a href="https://github.com/udacity/RL-Quadcopter">README</a>。 这一切就绪后，最后所要做的就是为每个任务正确定义 <strong>Task</strong> 和 <strong>Agent</strong> ，共涉及四个任务:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>任务1： 起飞</p>
<div class="paragraph">
<p>训练一个智能体成功地从地面起飞且到达某个阈值高度（如地上10个单位）。</p>
</div>
</li>
<li>
<p>任务2： 悬停</p>
<div class="paragraph">
<p>训练智能体使其起飞且悬停在设定的高度一段时间。</p>
</div>
</li>
<li>
<p>任务3： 着陆</p>
<div class="paragraph">
<p>训练智能体学会从地上某个位置温和地着陆。</p>
</div>
</li>
<li>
<p>任务4： 全套动作</p>
<div class="paragraph">
<p>实现一个端到端的任务，即起飞，原地悬停某个时长，然后着陆。</p>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_数据集和输入"><a class="link" href="#_数据集和输入">3. 数据集和输入</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>在这里，整个系统包括ROS，环境和智能体。环境和动作都是连续的，所以都被定义为 <a href="https://github.com/openai/gym/blob/master/gym/spaces/box.py">Box</a> 空间。环境为一个 <code>cube, cube_size x cube_size x cube_size</code>， 每个状态表示为一个7维向量 <code>&lt;position_x, .._y, .._z, orientation_x, .._y, .._z, .._w&gt;</code>， 前三个分量表示位置（pose），后四个分量组成一个四元数表示方向（orientation)。每个动作表示为一个6维向量 <code>&lt;force_x, .._y, .._z, torque_x, .._y, .._z&gt;</code>， 前三个分量组成力（force）的表示，后三个分量组成扭矩（torque）的表示。</p>
</div>
<div class="paragraph">
<p>针对不同的任务，状态空间和动作空间可以进行一定的优化。比如，在起飞任务中，我们可以不关注飞行器的方向，只需知道飞行器的位置（<strong>状态向量的前3个分量</strong>）。同样，只需要应用线性推力，不需要应用扭矩（<strong>这样还会防止出现不必要的旋转和歪斜</strong>）。在这个任务中，我们需要飞行器离地且达到某个高度，奖励可以根据飞行器当前高度与目标高度的距离来度量，当其达到或超过目标高度时进行额外奖励，如果在设定时间都没有完成，则进行额外惩罚。</p>
</div>
<div class="paragraph">
<p>此外，每种任务下飞行器的起始状态不同。比如在起飞（Takeoff）任务中，飞行器一开始处于某个随机高度（如可以采样自均值为0.5，标准差为0.1的正态分布）。而在着陆（Landing）任务中，飞行器一开始处于离地某个高度（如离地10个单位），并且具有一定的线性推力。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Solution-Description"><a class="link" href="#Solution-Description">4. 解决方案描述</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>项目涉及的环境和状态都是连续空间，这意味着只能选择适合连续状态和动作空间的算法或者将连续空间离散化。DQN的适用范围是低维、离散动作空间，在连续空间不能适用：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>如果采用把连续动作空间离散化，动作空间则会过大，极难收敛。</p>
</li>
<li>
<p>即使有些DQN的变种如VAE能提供连续动作的方案，但DQN只能给出一个确定性的动作，无法给出概率值。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>从另一个角度看，DQN是值基于的方法，最终还是求解策略。何不一开始就求解策略，这就是策略梯度（Policy Gradient）方法。在策略梯度方法中，设定参数化策略，然后计算得到动作上的策略梯度，沿着梯度方向，逐步调整动作，逐渐得到最优策略。策略梯度方法包括随机策略梯度（SPG）和确定性策略梯度（DPG）。</p>
</div>
<div class="paragraph">
<p><a href="https://arxiv.org/pdf/1509.02971.pdf">DDPG</a> 是结合了DQN和DPG，把DRL推向了 <strong>连续动作空间控制</strong>。 DDPG实际为一种行动者-评价者（actor-critic）方法，其架构图如下所示：</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/actor-critic-frame.png" alt="Actor-Critic 方法">
</div>
</div>
<div class="paragraph">
<p>Actor网络的输入是state，输出是action，使用DNN进行函数拟合，NN输出层使用tanh或sigmoid激励。Critic网络的输入是state和action，输出为Q值。此外，DDPG中借鉴了DQN中的经验回放和target网络，并且Actor和Critic的target网络均以小步长滞后更新，目的是让模型训练的更稳定。最后，通过在action的基础上增加随机噪声让智能体有机会探索环境。</p>
</div>
<div class="paragraph">
<p>在该项目中，选择实现DDPG方法以完成飞行器的控制任务。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_基准模型"><a class="link" href="#_基准模型">5. 基准模型</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>这里选择线性策略作为基准模型，设置如下：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>随机初始化策略参数</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-c1"># Policy parameters</span>
<span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">w</span> <span class="tok-o">=</span> <span class="tok-n">np</span><span class="tok-o">.</span><span class="tok-n">random</span><span class="tok-o">.</span><span class="tok-n">normal</span><span class="tok-p">(</span>
    <span class="tok-n">size</span><span class="tok-o">=</span><span class="tok-p">(</span><span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">state_size</span><span class="tok-p">,</span> <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">action_size</span><span class="tok-p">),</span>  <span class="tok-c1"># weights for simple linear policy: state_space x action_space</span>
    <span class="tok-n">scale</span><span class="tok-o">=</span><span class="tok-p">(</span><span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">action_range</span> <span class="tok-o">/</span> <span class="tok-p">(</span><span class="tok-mi">2</span> <span class="tok-o">*</span> <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">state_size</span><span class="tok-p">))</span><span class="tok-o">.</span><span class="tok-n">reshape</span><span class="tok-p">(</span><span class="tok-mi">1</span><span class="tok-p">,</span> <span class="tok-o">-</span><span class="tok-mi">1</span><span class="tok-p">))</span>  <span class="tok-c1"># start producing actions in a decent range</span></code></pre>
</div>
</div>
</li>
<li>
<p>使用线性策略选择动作</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-k">def</span> <span class="tok-nf">act</span><span class="tok-p">(</span><span class="tok-bp">self</span><span class="tok-p">,</span> <span class="tok-n">state</span><span class="tok-p">):</span>
   <span class="tok-c1"># Choose action based on given state and policy</span>
   <span class="tok-n">action</span> <span class="tok-o">=</span> <span class="tok-n">np</span><span class="tok-o">.</span><span class="tok-n">dot</span><span class="tok-p">(</span><span class="tok-n">state</span><span class="tok-p">,</span> <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">w</span><span class="tok-p">)</span>  <span class="tok-c1"># simple linear policy</span>
   <span class="tok-k">return</span> <span class="tok-n">action</span></code></pre>
</div>
</div>
</li>
<li>
<p>更新策略参数</p>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">w</span> <span class="tok-o">=</span> <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">w</span> <span class="tok-o">+</span> <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">noise_scale</span> <span class="tok-o">*</span> <span class="tok-n">np</span><span class="tok-o">.</span><span class="tok-n">random</span><span class="tok-o">.</span><span class="tok-n">normal</span><span class="tok-p">(</span><span class="tok-n">size</span><span class="tok-o">=</span><span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">w</span><span class="tok-o">.</span><span class="tok-n">shape</span><span class="tok-p">)</span>  <span class="tok-c1"># equal noise in all directions</span></code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>基准模型的存在是为了衡量要实现的DDPG方法的控制效果，这可以通过下个部分指定的<a href="#Metrics">评估指标</a>进行对比。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Metrics"><a class="link" href="#Metrics">6. 评估指标</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>在对强化学习解决方案进行迭代时，需要了解智能体的表现，这就需要建立评估指标。在该项目中，一个简单有效的评价指标是智能体在每个阶段获取的总奖励或最近若干个（比如10个）阶段的平均奖励变化，这可以通过保存阶段统计信息到文件，绘制episode rewards进行对比。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_项目设计"><a class="link" href="#_项目设计">7. 项目设计</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>在<a href="#Solution-Description">解决方案描述</a>部分已经确定了要使用的算法为DDPG。整个流程如下：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>定义任务（从 <code>BaseTask</code> 继承定义具体任务类）</p>
<div class="ulist">
<ul>
<li>
<p>在 <code>__init__()</code> 构造函数中完成观察空间（observation space)和动作空间（action space）的定义，设置一些任务相关的参数，如目标高度，最大用时等。</p>
</li>
<li>
<p>实现 <code>reset()</code> 方法和 <code>update()</code> 方法，前者在一开始或者阶段结束时调用，用于重置飞行器到起始状态。后者根据当前的状态对智能体进行奖惩，判断阶段是否结束，最后返回一个动作。</p>
</li>
</ul>
</div>
</li>
<li>
<p>定义智能体（从 <code>BaseAgent</code> 继承定义具体Agent类）</p>
<div class="ulist">
<ul>
<li>
<p>在 <code>__init__()</code> 构造函数中：</p>
</li>
<li>
<p>定义智能体的任务，状态和空间大小；</p>
</li>
<li>
<p>定义Actor和Critic网络（包括本地和target）并初始化；</p>
</li>
<li>
<p>设置经验回放和噪声过程；</p>
</li>
<li>
<p>设置其他参数，如gamma（折扣率），tau（软更新因子）以及回报统计保存文件名等。</p>
</li>
<li>
<p>实现 <code>step()</code> 方法。在该方法中，我们根据当前的状态s，回报以及完成标签选择下一个动作，使用经验回放技术训练模型以及保存回报统计信息。</p>
</li>
</ul>
</div>
</li>
<li>
<p>运行任务</p>
<div class="ulist">
<ul>
<li>
<p>运行ROS和模拟器</p>
</li>
<li>
<p>录屏最终的训练效果</p>
</li>
</ul>
</div>
</li>
<li>
<p>绘制阶段回报并进行性能分析</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>在这部分，我们绘制阶段回报信息：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">import</span> <span class="tok-nn">pandas</span> <span class="tok-kn">as</span> <span class="tok-nn">pd</span>

<span class="tok-n">df_stats</span> <span class="tok-o">=</span> <span class="tok-n">pd</span><span class="tok-o">.</span><span class="tok-n">read_csv</span><span class="tok-p">(</span><span class="tok-o">&lt;</span><span class="tok-n">csv_filename</span><span class="tok-o">&gt;</span><span class="tok-p">)</span>
<span class="tok-n">df_stats</span><span class="tok-p">[[</span><span class="tok-s1">&#39;total_reward&#39;</span><span class="tok-p">]]</span><span class="tok-o">.</span><span class="tok-n">plot</span><span class="tok-p">(</span><span class="tok-n">title</span><span class="tok-o">=</span><span class="tok-s2">&quot;Episode Rewards&quot;</span><span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="img/episode-rewards.png" alt="Episode Rewards">
</div>
</div>
<div class="sect2">
<h3 id="_takeoff_任务"><a class="link" href="#_takeoff_任务">7.1. Takeoff 任务</a></h3>
<div class="paragraph">
<p><strong>目标</strong>：训练智能体成功地从地面起飞，然后达到某个高度。</p>
</div>
<div class="paragraph">
<p>Episode Rewards Plot:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/takeoff/takeoff-episode-rewards.png" alt="episode-rewards">
</div>
</div>
<div class="paragraph">
<p><strong>Q:</strong> What algorithm did you use? Briefly discuss why you chose it for this task.</p>
</div>
<div class="paragraph">
<p><strong>A:</strong> I used an algorithm called DDPG, which is short for Deep Deterministic Policy Gradients and comes from the paper Continuous control with deep reinforcement learning. DDPG is a model-free policy based learning algorithm in which the agent learns directly from the unprocessed observation space without knowing the domain dynamic information, making it suited to solve control problems in continuous action space. It also employs actor-critic method in which actor model maps states into actions while critic model maps state-action pair into Q value. The visualization of actor and critic models is as following:</p>
</div>
<div class="paragraph">
<p>Actor:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/takeoff/actor.png" alt="actor model">
</div>
</div>
<div class="paragraph">
<p>Critic:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/takeoff/critic.png" alt="critic model">
</div>
</div>
<div class="paragraph">
<p><strong>Q:</strong> Using the episode rewards plot, discuss how the agent learned over time.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Was it an easy task to learn or hard?</p>
</li>
<li>
<p>Was there a gradual learning curve, or an aha moment?</p>
</li>
<li>
<p>How good was the final performance of the agent? (e.g. mean rewards over the last 10 episodes)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>A</strong>: It was an easy task to learn, from episode rewards plot we can see after around only 25 episodes the agent manages to learn how to take off.
In this training case, there was not a gradual learning curve but an aha moment, which is around the 25th episode, before that moment the agent moves around but its height doesn&#8217;t increase, leading to unchanged reward, after that moment the agent manages to learn how to lift from ground.
The mean rewards over the last 10 episodes is around -600.</p>
</div>
</div>
<div class="sect2">
<h3 id="_hover_任务"><a class="link" href="#_hover_任务">7.2. Hover 任务</a></h3>
<div class="paragraph">
<p><strong>目标：</strong> 训练智能体起飞并且悬停在某个点（如地上10个单位高度）。</p>
</div>
<div class="paragraph">
<p>Episode Rewards Plot:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/hover/episode-rewards.png" alt="episode-rewards">
</div>
</div>
<div class="paragraph">
<p><strong>Q:</strong> Did you change the state representation or reward function? If so, please explain below what worked best for you, and why you chose that scheme. Include short code snippet(s) if needed.</p>
</div>
<div class="paragraph">
<p><strong>A:</strong> Yes, I changed the state representation, reward function was also changed. The new state representation is as following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-k">if</span> <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">last_pose</span> <span class="tok-ow">is</span> <span class="tok-bp">None</span><span class="tok-p">:</span>
            <span class="tok-n">dist_last_pose</span> <span class="tok-o">=</span> <span class="tok-n">np</span><span class="tok-o">.</span><span class="tok-n">array</span><span class="tok-p">([</span><span class="tok-mf">0.</span><span class="tok-p">,</span> <span class="tok-mf">0.</span><span class="tok-p">,</span> <span class="tok-mf">0.</span><span class="tok-p">])</span>
<span class="tok-k">else</span><span class="tok-p">:</span>
    <span class="tok-n">dist_last_pose</span> <span class="tok-o">=</span> <span class="tok-n">np</span><span class="tok-o">.</span><span class="tok-n">array</span><span class="tok-p">([</span>
        <span class="tok-nb">abs</span><span class="tok-p">(</span><span class="tok-n">pose</span><span class="tok-o">.</span><span class="tok-n">position</span><span class="tok-o">.</span><span class="tok-n">x</span> <span class="tok-o">-</span> <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">last_pose</span><span class="tok-o">.</span><span class="tok-n">position</span><span class="tok-o">.</span><span class="tok-n">x</span><span class="tok-p">),</span>
        <span class="tok-nb">abs</span><span class="tok-p">(</span><span class="tok-n">pose</span><span class="tok-o">.</span><span class="tok-n">position</span><span class="tok-o">.</span><span class="tok-n">y</span> <span class="tok-o">-</span> <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">last_pose</span><span class="tok-o">.</span><span class="tok-n">position</span><span class="tok-o">.</span><span class="tok-n">y</span><span class="tok-p">),</span>
        <span class="tok-nb">abs</span><span class="tok-p">(</span><span class="tok-n">pose</span><span class="tok-o">.</span><span class="tok-n">position</span><span class="tok-o">.</span><span class="tok-n">z</span> <span class="tok-o">-</span> <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">last_pose</span><span class="tok-o">.</span><span class="tok-n">position</span><span class="tok-o">.</span><span class="tok-n">z</span><span class="tok-p">)</span>
    <span class="tok-p">])</span>
<span class="tok-n">dist_target_z</span> <span class="tok-o">=</span> <span class="tok-nb">abs</span><span class="tok-p">(</span><span class="tok-n">pose</span><span class="tok-o">.</span><span class="tok-n">position</span><span class="tok-o">.</span><span class="tok-n">z</span> <span class="tok-o">-</span> <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">target_z</span><span class="tok-p">)</span>

<span class="tok-n">state</span> <span class="tok-o">=</span> <span class="tok-n">np</span><span class="tok-o">.</span><span class="tok-n">concatenate</span><span class="tok-p">([</span>
    <span class="tok-n">np</span><span class="tok-o">.</span><span class="tok-n">array</span><span class="tok-p">([</span><span class="tok-n">pose</span><span class="tok-o">.</span><span class="tok-n">position</span><span class="tok-o">.</span><span class="tok-n">x</span><span class="tok-p">,</span> <span class="tok-n">pose</span><span class="tok-o">.</span><span class="tok-n">position</span><span class="tok-o">.</span><span class="tok-n">y</span><span class="tok-p">,</span> <span class="tok-n">pose</span><span class="tok-o">.</span><span class="tok-n">position</span><span class="tok-o">.</span><span class="tok-n">z</span><span class="tok-p">]),</span>
    <span class="tok-n">dist_last_pose</span><span class="tok-p">,</span>
    <span class="tok-n">np</span><span class="tok-o">.</span><span class="tok-n">array</span><span class="tok-p">([</span><span class="tok-n">dist_target_z</span><span class="tok-p">])</span>
<span class="tok-p">])</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, I included the difference between current pose and last pose, and the difference between current pose and target in z direction. These two components serves to make the agent sense whether leave target or current pose too far, thus making a well hovering.</p>
</div>
<div class="paragraph">
<p>As for reward function, the new one is as following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-n">reward</span> <span class="tok-o">=</span> <span class="tok-p">(</span><span class="tok-mf">10.0</span> <span class="tok-o">-</span> <span class="tok-n">dist_target_z</span><span class="tok-p">)</span> <span class="tok-o">*</span> <span class="tok-mf">0.8</span>
<span class="tok-k">if</span> <span class="tok-n">pose</span><span class="tok-o">.</span><span class="tok-n">position</span><span class="tok-o">.</span><span class="tok-n">z</span> <span class="tok-o">&gt;=</span> <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">target_z</span><span class="tok-p">:</span>
    <span class="tok-n">reward</span> <span class="tok-o">+=</span> <span class="tok-mf">2.0</span>  <span class="tok-c1"># give a small bonus</span>
    <span class="tok-k">if</span> <span class="tok-n">dist_target_z</span> <span class="tok-o">&lt;=</span> <span class="tok-mf">2.0</span><span class="tok-p">:</span>
        <span class="tok-n">reward</span> <span class="tok-o">+=</span> <span class="tok-mf">5.0</span>  <span class="tok-c1"># bonus reward, agent starts to hover</span>
        <span class="tok-k">if</span> <span class="tok-n">linear_acc</span><span class="tok-p">:</span>
            <span class="tok-n">reward</span> <span class="tok-o">-=</span> <span class="tok-mf">0.1</span> <span class="tok-o">*</span> <span class="tok-n">linear_acc</span>
        <span class="tok-k">if</span> <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">start_hover</span> <span class="tok-ow">is</span> <span class="tok-bp">None</span><span class="tok-p">:</span>
            <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">start_hover</span> <span class="tok-o">=</span> <span class="tok-n">timestamp</span>
        <span class="tok-k">elif</span> <span class="tok-n">timestamp</span> <span class="tok-o">-</span> <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">start_hover</span> <span class="tok-o">&gt;=</span> <span class="tok-mf">0.5</span><span class="tok-p">:</span>  <span class="tok-c1"># give reward if hover for some time</span>
            <span class="tok-n">reward</span> <span class="tok-o">+=</span> <span class="tok-mf">2.0</span>
    <span class="tok-k">elif</span> <span class="tok-n">dist_target_z</span> <span class="tok-o">&gt;</span> <span class="tok-mf">5.0</span><span class="tok-p">:</span>  <span class="tok-c1"># agent leaves target too far</span>
        <span class="tok-k">if</span> <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">count</span> <span class="tok-o">%</span> <span class="tok-mi">20</span> <span class="tok-o">==</span> <span class="tok-mi">0</span><span class="tok-p">:</span>
            <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;last duration: {}&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">timestamp</span><span class="tok-p">))</span>
        <span class="tok-k">if</span> <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">start_hover</span> <span class="tok-ow">is</span> <span class="tok-ow">not</span> <span class="tok-bp">None</span><span class="tok-p">:</span>
            <span class="tok-k">print</span><span class="tok-p">(</span><span class="tok-s2">&quot;last duration: {:.4f}&quot;</span><span class="tok-o">.</span><span class="tok-n">format</span><span class="tok-p">(</span><span class="tok-n">timestamp</span> <span class="tok-o">-</span> <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">start_hover</span><span class="tok-p">))</span>
        <span class="tok-n">done</span> <span class="tok-o">=</span> <span class="tok-bp">True</span>
    <span class="tok-k">else</span><span class="tok-p">:</span>
        <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">start_hover</span> <span class="tok-o">=</span> <span class="tok-bp">None</span>
<span class="tok-k">if</span> <span class="tok-n">timestamp</span> <span class="tok-o">&gt;</span> <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">max_duration</span><span class="tok-p">:</span>  <span class="tok-c1"># agent has run out of time</span>
    <span class="tok-n">reward</span> <span class="tok-o">-=</span> <span class="tok-mf">5.0</span>
    <span class="tok-n">done</span> <span class="tok-o">=</span> <span class="tok-bp">True</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The reward function seems a litte complex. The base reward function is just like the one in takeoff task, when the agent leaves the target too far, it gets a smaller reward. Then if it cross over the target, it gets a small reward and if it stays in a some range between target, it gets a slight big reward. At the same time, the agent gets a penalty if it has a big linear acceration in z direction when hovering.</p>
</div>
<div class="paragraph">
<p><strong>实现notes</strong></p>
</div>
<div class="paragraph">
<p><strong>Q:</strong> Discuss your implementation below briefly, using the following questions as a guide:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>What algorithm(s) did you try? What worked best for you?</p>
</li>
<li>
<p>What was your final choice of hyperparameters (such as  𝛼 ,  𝛾 ,  𝜖 , etc.)?</p>
</li>
<li>
<p>What neural network architecture did you use (if any)? Specify layers, sizes, activation functions, etc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>A:</strong> Again I used DDPG algorithm, it&#8217;s same with that used in takeoff task. Because the state representation was changed, so the states input layer of actor and critic models has different input shape as following:</p>
</div>
<div class="paragraph">
<p>Actor:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/hover/actor.png" alt="actor model">
</div>
</div>
<div class="paragraph">
<p>Critic:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/hover/critic.png" alt="critic model">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The hyperparameters  𝛼 ,  𝛾  used in this task is 0.001 and 0.99. A noise produced by Ornstein-Uhlenbeck process is added to action, where  𝜇 =0.0,  𝜃 =0.15 and  𝜎 =0.3.</p>
</li>
<li>
<p>For neural network architecture please see beforemetioned actor and critic models diagram, the activation function is relu.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_landing_任务"><a class="link" href="#_landing_任务">7.3. Landing 任务</a></h3>
<div class="paragraph">
<p><strong>目标</strong>：让智能体温和地着地。</p>
</div>
<div class="paragraph">
<p>Episode Rewards Plot:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/landing/episode-rewards.png" alt="episode-rewards">
</div>
</div>
<div class="paragraph">
<p><strong>初始条件，状态和回报</strong></p>
</div>
<div class="paragraph">
<p><strong>Q:</strong> How did you change the initial condition (starting state), state representation and/or reward function? Please explain below what worked best for you, and why you chose that scheme. Were you able to build in a reward mechanism for landing gently?</p>
</div>
<div class="paragraph">
<p><strong>A:</strong> Because this time we need to make the quadcopter land, so the initial condition is the quadcopter is in the air as following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-k">def</span> <span class="tok-nf">reset</span><span class="tok-p">(</span><span class="tok-bp">self</span><span class="tok-p">):</span>
    <span class="tok-o">...</span>
    <span class="tok-k">return</span> <span class="tok-n">Pose</span><span class="tok-p">(</span>
                    <span class="tok-n">position</span><span class="tok-o">=</span><span class="tok-n">Point</span><span class="tok-p">(</span><span class="tok-mf">0.0</span><span class="tok-p">,</span> <span class="tok-mf">0.0</span><span class="tok-p">,</span> <span class="tok-mf">10.0</span><span class="tok-p">),</span>  <span class="tok-c1"># Land from height of 10 units above ground</span>
                    <span class="tok-n">orientation</span><span class="tok-o">=</span><span class="tok-n">Quaternion</span><span class="tok-p">(</span><span class="tok-mf">0.0</span><span class="tok-p">,</span> <span class="tok-mf">0.0</span><span class="tok-p">,</span> <span class="tok-mf">0.0</span><span class="tok-p">,</span> <span class="tok-mf">0.0</span><span class="tok-p">),</span>
                <span class="tok-p">),</span> <span class="tok-n">Twist</span><span class="tok-p">(</span>
                    <span class="tok-n">linear</span><span class="tok-o">=</span><span class="tok-n">Vector3</span><span class="tok-p">(</span><span class="tok-mf">0.0</span><span class="tok-p">,</span> <span class="tok-mf">0.0</span><span class="tok-p">,</span> <span class="tok-mf">0.0</span><span class="tok-p">),</span>
                    <span class="tok-n">angular</span><span class="tok-o">=</span><span class="tok-n">Vector3</span><span class="tok-p">(</span><span class="tok-mf">0.0</span><span class="tok-p">,</span> <span class="tok-mf">0.0</span><span class="tok-p">,</span> <span class="tok-mf">0.0</span><span class="tok-p">)</span>
                <span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The state representation here is same with which used in hover task. The reward function (core part) is as following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-n">reward</span> <span class="tok-o">=</span> <span class="tok-p">(</span><span class="tok-mf">10.0</span> <span class="tok-o">-</span> <span class="tok-n">dist_target_z</span><span class="tok-p">)</span> <span class="tok-o">*</span> <span class="tok-mf">0.8</span>
<span class="tok-k">if</span> <span class="tok-n">pose</span><span class="tok-o">.</span><span class="tok-n">position</span><span class="tok-o">.</span><span class="tok-n">z</span> <span class="tok-o">&lt;=</span> <span class="tok-mf">0.5</span><span class="tok-p">:</span>
    <span class="tok-n">reward</span> <span class="tok-o">+=</span> <span class="tok-mf">5.0</span>  <span class="tok-c1"># give a small bonus</span>
    <span class="tok-k">if</span> <span class="tok-n">linear_acc</span><span class="tok-p">:</span>
        <span class="tok-n">reward</span> <span class="tok-o">-=</span> <span class="tok-mf">0.1</span> <span class="tok-o">*</span> <span class="tok-n">linear_acc</span>
    <span class="tok-n">done</span> <span class="tok-o">=</span> <span class="tok-bp">True</span>
<span class="tok-k">elif</span> <span class="tok-n">timestamp</span> <span class="tok-o">&gt;</span> <span class="tok-bp">self</span><span class="tok-o">.</span><span class="tok-n">max_duration</span><span class="tok-p">:</span>  <span class="tok-c1"># agent has run out of time</span>
    <span class="tok-n">reward</span> <span class="tok-o">-=</span> <span class="tok-mf">5.0</span>
    <span class="tok-n">done</span> <span class="tok-o">=</span> <span class="tok-bp">True</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As before, the base part of reward function states that when the agent has a smaller difference with target, it gets a higher reward. When the agent falls in some small range between target, it gets a bonus, at the same time it gets penalty because of linear acceleration in z direction.</p>
</div>
<div class="paragraph">
<p><strong>实现notes</strong></p>
</div>
<div class="paragraph">
<p><strong>Q:</strong> Discuss your implementation below briefly, using the same questions as before to guide you.</p>
</div>
<div class="paragraph">
<p><strong>A:</strong> The agent used here is totally same with the one used in hover task.</p>
</div>
</div>
<div class="sect2">
<h3 id="_reflections"><a class="link" href="#_reflections">7.4. Reflections</a></h3>
<div class="paragraph">
<p><strong>Q:</strong> Briefly summarize your experience working on this project. You can use the following prompts for ideas.</p>
</div>
<div class="paragraph">
<p>What was the hardest part of the project? (e.g. getting started, running ROS, plotting, specific task, etc.)
How did you approach each task and choose an appropriate algorithm/implementation for it?
Did you find anything interesting in how the quadcopter or your agent behaved?</p>
</div>
<div class="paragraph">
<p><strong>A:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>The hardest part of the project for me was composing a well working state representation and reward function.</p>
</li>
<li>
<p>All tasks are of continuous controlling, so a working agent implementation is needed. DDPG is a model-free policy based learning algorithm in which the agent learns directly from the unprocessed observation space without knowing the domain dynamic information, making it suited to solve control problems in continuous action space. So I choosed DDPG. For each task, to compose a well working reward function and hyperparameters, constant tries are needed and observe the performance of the agent and make a proper change.</p>
</li>
<li>
<p>Interesting things in how the quadcopter behaved are:</p>
<div class="ulist">
<ul>
<li>
<p>At some time, the agent does the right thing at the first start;</p>
</li>
<li>
<p>At other time, the agent learns nothing;</p>
</li>
<li>
<p>Even for the agent learns how to well behaved, fluctuation may occurr.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_参考"><a class="link" href="#_参考">8. 参考</a></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://www.zhihu.com/question/47602063/answer/150845355" class="bare">https://www.zhihu.com/question/47602063/answer/150845355</a></p>
</li>
<li>
<p><a href="https://openai.com/blog/openai-gym-beta" class="bare">https://openai.com/blog/openai-gym-beta</a></p>
</li>
<li>
<p><a href="https://zhuanlan.zhihu.com/p/39999667" class="bare">https://zhuanlan.zhihu.com/p/39999667</a></p>
</li>
<li>
<p><a href="https://zhuanlan.zhihu.com/p/25239682" class="bare">https://zhuanlan.zhihu.com/p/25239682</a></p>
</li>
<li>
<p><a href="https://arxiv.org/pdf/1509.02971.pdf" class="bare">https://arxiv.org/pdf/1509.02971.pdf</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version v0.1<br>
Last updated 2019-06-01 21:48:53 +0800
</div>
</div>
</body>
</html>